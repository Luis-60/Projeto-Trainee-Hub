@model Projeto_Trainee_Hub.ViewModel.TreinamentoModuloViewModel
@{
    ViewData["Title"] = "Treinamentos";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="texto_modulo" style="margin-left: 160px;">
    <div class="d-flex align-items-center gap-4">
        <h1 class="m-0" style="font-size: 64px; margin-top: 40px; line-break: anywhere">@Model.treinamentos.Nome</h1>
        <p class="m-0" style="font-size: 20px; line-break: anywhere; margin-left: 10px;">@Model.treinamentos.Descricao</p>
    </div>
    <div class="btnModulo" style="display: flex; gap: 10px; justify-content: flex-end;">
        <button class="btn btn-success adicionar" onclick="OpenModal('modal-modulo')">Adicionar Módulo</button>
        <button class="btn btn-primary btnAbrirAdd" onclick="OpenModal('modal-treinamentoE')">✏️ Editar</button>
        <div class="btn-group">
            <form asp-controller="Treinamentos" asp-action="Deletar" method="post" onsubmit="return confirm('Tem certeza que quer deletar o treinamento?')">
                @Html.AntiForgeryToken()
                <input type="hidden" name="IdTreinamentos" value="@Model.treinamentos.IdTreinamentos" />
                <button type="submit" class="btn btn-danger">🗑 Deletar</button>
            </form>
        </div>
    </div>
</div>

<hr>

<ul class="bloco_modulos">
    @foreach (var modulo in Model.listaModulos)
    {
        <li class="header">
            <div class="Modulos">
                <h2>MÓDULO @modulo.Sequencia - @modulo.Nome</h2>
                <div class="Botoes">
                    <a asp-action="Modulos" asp-controller="Admin" asp-route-id="@modulo.IdModulos" aspclass="conteudo">📄 CONTEÚDO</a>
                    <button type="button" class="editar" onclick="preencherModalEditar('@modulo.IdModulos', '@modulo.Nome', '@modulo.Descricao', '@modulo.Sequencia')">✏️</button>
                    <form asp-controller="Modulos" asp-action="Deletar" method="post" onsubmit="return confirm('Tem certeza que quer deletar módulo?')">
                        @Html.AntiForgeryToken()
                        <input type="hidden" name="idModulo" value="@modulo.IdModulos" />
                        <button class="excluir btn btn-danger">🗑</button>
                    </form>
                </div>
                <div class="selecionar">
                    <input type="checkbox" id="modulo1">
                    <label for="modulo1">1. LoreIpsum</label>
                </div>
            </div>
        </li>
    }
</ul>

<!-- Modal CRIAR Módulo -->
<div class="modal" id="modal-modulo">
    <div class="modal-content">
        <h1 class="titulo-modal">CRIAR MÓDULO</h1>
        <form asp-action="CriarModulo" asp-controller="Modulos">
            <div class="inputnome">
                <label>Nome:</label><br>
                <input type="text" asp-for="@Model.modulos.Nome" class="input-nome" placeholder="Insira o nome do módulo" id="nome">
            </div>
            <label>Descrição:</label><br>
            <textarea asp-for="@Model.modulos.Descricao" placeholder="Descreva o módulo" style="width:100%" id="descricao"></textarea>
            <div class="buttons">
                <button class="btnAddTreinamento">CRIAR</button>
                <button class="btnClose" onclick="closeModal()">SAIR</button>
            </div>
            <input type="hidden" id="treinamento" asp-for="@Model.treinamentos.IdTreinamentos" value="@Model.treinamentos.IdTreinamentos">
            <input type="hidden" id="sequencia" asp-for="@Model.modulos.Sequencia" value="0">
        </form>
    </div>
</div>

<!-- Modal EDITAR Módulo -->
<div class="modal" id="modal-moduloE">
    <div class="modal-content">
        <h1 class="titulo-modal">EDITAR MÓDULO</h1>
        <form asp-action="Editar" asp-controller="Modulos" method="post">
            <div class="inputnome">
                <label>Nome:</label><br>
                <input type="text" asp-for="@Model.modulos.Nome" class="input-nome" placeholder="Insira o nome do módulo" id="nome-editar">
            </div>
            <label>Descrição:</label><br>
            <textarea asp-for="@Model.modulos.Descricao" placeholder="Descreva o módulo" style="width:100%" id="descricao-editar"></textarea>

            <input type="hidden" name="modulos.IdModulos" id="modulo-id" />
            <input type="hidden" id="sequencia-editar" name="modulos.Sequencia" />
            <input type="hidden" name="treinamentos.IdTreinamentos" value="@Model.treinamentos.IdTreinamentos" />

            <div class="buttons">
                <button type="submit" class="btnAddTreinamento">SALVAR</button>
                <button type="button" class="btnClose" onclick="closeModal()">SAIR</button>
            </div>
        </form>
    </div>
</div>

<script>
    function preencherModalEditar(id, nome, descricao, sequencia) {
        document.getElementById('modulo-id').value = id;
        document.getElementById('nome-editar').value = nome;
        document.getElementById('descricao-editar').value = descricao;
        document.getElementById('sequencia-editar').value = sequencia;

        OpenModal('modal-moduloE');
    }
</script>
